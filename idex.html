<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SuaPetição - Gerador de Petições com IA</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    :root {
      --primary-green-dark: #004d40;
      --primary-green-medium: #26a69a;
      --primary-green-light: #e0f2f1;
      --neutral-dark: #212121;
      --neutral-medium: #616161;
      --neutral-light: #f5f5f5;
      --background-color: #ffffff;
      --error-color: #d32f2f;
      --error-background: #ffebee;
    }
    * { margin:0; padding:0; box-sizing:border-box; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    html { scroll-behavior:smooth; }
    body { font-family:'Poppins',sans-serif; background:var(--background-color); color:var(--neutral-dark); font-size:16px; line-height:1.6; }
    .container { max-width:1100px; margin:0 auto; padding:0 20px; }

    header { background:var(--background-color); padding:1rem 0; border-bottom:1px solid #e0e0e0; position:fixed; top:0; left:0; width:100%; z-index:1000; transition:box-shadow .3s; }
    header.scrolled { box-shadow:0 2px 10px rgba(0,0,0,.05); }
    .header-content { display:flex; justify-content:space-between; align-items:center; }
    .logo { font-size:1.5rem; font-weight:700; color:var(--primary-green-dark); text-decoration:none; }
    .logo span { color:var(--primary-green-medium); }

    nav ul { display:flex; align-items:center; list-style:none; gap:1.5rem; }
    nav a:not(.btn){ text-decoration:none; color:var(--neutral-medium); font-weight:500; position:relative; transition:color .3s; padding:.5rem 0; }
    nav a:not(.btn):hover{ color:var(--primary-green-dark); }
    nav a:not(.btn)::after{ content:''; position:absolute; width:0; height:2px; bottom:0; left:0; background:var(--primary-green-medium); transition:width .3s; }
    nav a:not(.btn):hover::after{ width:100%; }

    .hamburger{ display:none; cursor:pointer; border:none; background:none; }
    .hamburger .bar{ display:block; width:25px; height:3px; margin:5px auto; background:var(--primary-green-dark); transition:all .3s; }

    .btn{ padding:.75rem 1.5rem; border-radius:50px; text-decoration:none; font-weight:600; transition:all .3s; display:inline-block; text-align:center; border:none; cursor:pointer; }
    .btn-primary{ background:var(--primary-green-medium); color:#fff; box-shadow:0 4px 15px rgba(0,121,107,.2); }
    .btn-primary:hover{ transform:translateY(-2px); box-shadow:0 6px 20px rgba(0,121,107,.3); }
    .btn-secondary{ border:2px solid var(--primary-green-medium); color:var(--primary-green-medium); background:transparent; }
    .btn-secondary:hover{ background:var(--primary-green-medium); color:#fff; }

    section{ padding:6rem 0; }
    .section-title{ text-align:center; font-size:2.5rem; font-weight:700; color:var(--primary-green-dark); margin-bottom:1rem; }
    .section-subtitle{ text-align:center; font-size:1.1rem; color:var(--neutral-medium); max-width:600px; margin:0 auto 4rem; }

    #hero{ padding-top:10rem; min-height:100vh; display:flex; align-items:center; }
    .hero-content{ display:flex; align-items:center; justify-content:space-between; gap:4rem; }
    .hero-text{ max-width:50%; }
    .hero-text h1{ font-size:3rem; font-weight:700; line-height:1.2; color:var(--primary-green-dark); margin-bottom:1rem; }
    .hero-text p{ font-size:1.2rem; color:var(--neutral-medium); margin-bottom:2rem; }
    .hero-image{ max-width:45%; }
    .hero-image img{ width:100%; height:auto; border-radius:10px; }

    #how-it-works{ background:var(--neutral-light); }
    .steps-container{ display:flex; justify-content:space-around; gap:2rem; margin-top:4rem; }
    .step-card{ background:#fff; padding:2.5rem 2rem; border-radius:10px; text-align:center; box-shadow:0 5px 25px rgba(0,0,0,.05); transition:transform .3s, box-shadow .3s; flex:1; }
    .step-card:hover{ transform:translateY(-10px); box-shadow:0 10px 30px rgba(0,0,0,.08); }
    .step-number{ font-size:3rem; font-weight:700; color:var(--primary-green-light); background:var(--primary-green-medium); width:80px; height:80px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 1.5rem; }
    .step-card h3{ font-size:1.5rem; color:var(--primary-green-dark); margin-bottom:.5rem; }

    .faq-item{ border-bottom:1px solid #e0e0e0; padding:1.5rem 0; }
    .faq-question{ display:flex; justify-content:space-between; align-items:center; cursor:pointer; font-size:1.2rem; font-weight:600; }
    .faq-question:hover{ color:var(--primary-green-medium); }
    .faq-answer{ max-height:0; overflow:hidden; transition:max-height .3s ease-out; color:var(--neutral-medium); }
    .faq-answer p{ padding-top:1rem; }
    .faq-item.active .faq-answer{ padding-bottom:1rem; }
    .faq-toggle{ font-size:1.5rem; font-weight:bold; transition:transform .3s; }
    .faq-item.active .faq-toggle{ transform:rotate(45deg); }

    #form-section{ background:var(--neutral-light); }
    .form-container{ background:#fff; padding:3rem; border-radius:10px; box-shadow:0 5px 25px rgba(0,0,0,.07); max-width:800px; margin:0 auto; overflow:hidden; }
    .quiz-step{ display:none; animation:fadeIn .5s ease-in-out; }
    .quiz-step.active{ display:block; }
    @keyframes fadeIn{ from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }

    .quiz-question{ font-size:1.75rem; font-weight:600; color:var(--primary-green-dark); margin-bottom:2rem; text-align:center; }
    .form-group{ display:flex; flex-direction:column; margin-bottom:1.5rem; }
    .form-group label{ font-weight:600; margin-bottom:.5rem; color:var(--primary-green-dark); }
    .form-group input, .form-group select, .form-group textarea{ width:100%; padding:.8rem 1rem; border-radius:8px; border:1px solid #ccc; font-family:'Poppins',sans-serif; font-size:1rem; transition:border-color .3s, box-shadow .3s; }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus{ outline:none; border-color:var(--primary-green-medium); box-shadow:0 0 0 3px rgba(38,166,154,.2); }
    .form-group textarea{ min-height:120px; resize:vertical; }

    .options-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:1rem; justify-content:center; }
    .radio-options{ display:flex; flex-direction:column; gap:1rem; }
    .options-grid label, .radio-options label, .checkbox-options label{ display:flex; align-items:center; gap:.75rem; cursor:pointer; font-weight:500; padding:.8rem 1.5rem; border:1px solid #ccc; border-radius:8px; transition:all .2s; text-align:left; }
    .options-grid label:hover, .radio-options label:hover, .checkbox-options label:hover{ background:var(--primary-green-light); border-color:var(--primary-green-medium); }
    .options-grid input[type="radio"], .radio-options input[type="radio"], .checkbox-options input[type="checkbox"]{ display:none; }
    .options-grid input[type="radio"]:checked ~ span, .radio-options input[type="radio"]:checked ~ span, .checkbox-options input[type="checkbox"]:checked ~ span{ font-weight:600; color:var(--primary-green-dark); }
    .options-grid input[type="radio"]:checked ~ span::before, .radio-options input[type="radio"]:checked ~ span::before, .checkbox-options input[type="checkbox"]:checked ~ span::before{ content:'✔'; margin-right:.5rem; color:var(--primary-green-medium); }
    .options-grid input[type="radio"]:checked + label, .radio-options input[type="radio"]:checked + label, .checkbox-options input[type="checkbox"]:checked + label{ border-color:var(--primary-green-medium); background:var(--primary-green-light); }

    .form-group.invalid input, .form-group.invalid select, .form-group.invalid textarea{ border:1px solid var(--error-color); background:var(--error-background); }
    .form-group.invalid .options-grid, .form-group.invalid .radio-options, .form-group.invalid .checkbox-options{ border:1px solid var(--error-color); background:var(--error-background); border-radius:8px; padding:1rem; }
    .error-message{ color:var(--error-color); font-size:.875rem; margin-top:.25rem; display:none; }
    .form-group.invalid .error-message{ display:block; }

    .progress-container{ margin-bottom:2rem; position:relative; }
    .progress-bar-track{ width:100%; height:10px; background:#e0e0e0; border-radius:5px; overflow:hidden; }
    .progress-bar-fill{ width:0%; height:100%; background:var(--primary-green-medium); border-radius:5px; transition:width .4s; }
    .progress-text{ text-align:center; margin-top:.5rem; color:var(--neutral-medium); font-weight:500; }

    .quiz-navigation{ display:flex; justify-content:space-between; margin-top:3rem; }
    .quiz-navigation button{ font-size:1rem; }

    #result-screen{ text-align:center; }
    #result-screen h3{ font-size:2rem; color:var(--primary-green-dark); margin-bottom:1rem; }
    #result-screen p{ font-size:1.1rem; color:var(--neutral-medium); margin-bottom:2rem; }
    #result-screen ul{ list-style:none; text-align:left; display:inline-block; margin-bottom:2.5rem; }
    #result-screen ul li{ font-size:1.1rem; margin-bottom:1rem; }

    footer{ background:var(--primary-green-dark); color:#fff; padding:3rem 0; text-align:center; }
    .footer-content{ display:flex; flex-direction:column; align-items:center; gap:1.5rem; }
    .footer-links{ list-style:none; display:flex; gap:1.5rem; }
    .footer-links a{ color:#fff; text-decoration:none; transition:color .3s; }
    .footer-links a:hover{ color:var(--primary-green-medium); }

    @media (max-width:992px){
      .hero-content{ flex-direction:column; text-align:center; }
      .hero-text, .hero-image{ max-width:100%; }
      .steps-container{ flex-direction:column; }
    }
    @media (max-width:768px){
      html{ font-size:93.75%; }
      nav ul{ position:fixed; left:-100%; top:73px; flex-direction:column; background:#fff; width:100%; text-align:center; transition:.3s; gap:0; box-shadow:0 10px 10px rgba(0,0,0,.05); }
      nav ul.active{ left:0; }
      nav li{ width:100%; }
      nav a{ padding:1.5rem 1rem; display:block; width:100%; border-bottom:1px solid #f0f0f0; }
      .btn-nav{ margin:1rem; display:block; }
      nav a:not(.btn)::after{ display:none; }
      .hamburger{ display:block; }
      .hamburger.active .bar:nth-child(2){ opacity:0; }
      .hamburger.active .bar:nth-child(1){ transform:translateY(8px) rotate(45deg); }
      .hamburger.active .bar:nth-child(3){ transform:translateY(-8px) rotate(-45deg); }
      .form-container{ padding:2rem; }
    }
  </style>
</head>
<body>
  <header id="main-header">
    <div class="container header-content">
      <a href="#" class="logo">Sua<span>Petição</span></a>
      <nav>
        <ul class="nav-menu">
          <li><a href="#how-it-works">Como funciona</a></li>
          <li><a href="#faq">Perguntas frequentes</a></li>
          <li><a href="#">Contato</a></li>
          <li><a href="#">Meu perfil</a></li>
          <li><a href="#form-section" class="btn btn-secondary btn-nav">Criar Petição</a></li>
        </ul>
      </nav>
      <button class="hamburger">
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
      </button>
    </div>
  </header>

  <main>
    <!-- HERO -->
    <section id="hero">
      <div class="container hero-content">
        <div class="hero-text">
          <h1>Gerador de Petições Iniciais com Inteligência Artificial</h1>
          <p>Rápido, simples e pronto para protocolar no Juizado. Crie seu documento jurídico em minutos e defenda seus direitos com mais facilidade.</p>
          <a href="#form-section" class="btn btn-primary">Criar Petição Agora</a>
        </div>
        <div class="hero-image">
          <img src="https://images.unsplash.com/photo-1560520653-9e0e4c89eb18?q=80&w=1974&auto=format&fit=crop" alt="Pessoa assinando um documento legal">
        </div>
      </div>
    </section>

    <!-- COMO FUNCIONA -->
    <section id="how-it-works">
      <div class="container">
        <h2 class="section-title">Como Funciona?</h2>
        <p class="section-subtitle">Em três passos simples, sua petição estará pronta para ser protocolada.</p>
        <div class="steps-container">
          <div class="step-card">
            <div class="step-number">1</div>
            <h3>Preencha o Formulário</h3>
            <p>Informe os detalhes do seu caso de forma guiada e intuitiva. Nossa plataforma pergunta tudo o que é necessário.</p>
          </div>
          <div class="step-card">
            <div class="step-number">2</div>
            <h3>A IA Monta a Petição</h3>
            <p>Nossa Inteligência Artificial analisa suas informações e redige uma petição inicial completa, em linguagem jurídica e formatada corretamente.</p>
          </div>
          <div class="step-card">
            <div class="step-number">3</div>
            <h3>Imprima e Protocole</h3>
            <p>Você recebe o documento pronto para imprimir, assinar e levar ao Juizado Especial Cível da sua cidade, junto com seus documentos.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- FORM -->
    <section id="form-section">
      <div class="container">
        <h2 class="section-title">Crie Sua Petição</h2>
        <p class="section-subtitle">Responda algumas perguntas e nossa IA montará o documento para você.</p>

        <div class="form-container" id="quiz-wrapper">
          <div id="result-screen" style="display:none;">
            <h3>Petição Gerada com Sucesso!</h3>
            <p>Seu documento foi baixado. Siga os próximos passos para protocolar sua ação:</p>
            <ul>
              <li>✅ Abra o arquivo 'peticao.pdf' que foi salvo no seu computador.</li>
              <li>✅ Imprima 3 vias do documento.</li>
              <li>✅ Junte cópias dos seus documentos pessoais (RG, CPF, Comprovante de Residência).</li>
              <li>✅ Anexe todas as provas que você mencionou (notas fiscais, protocolos, prints, etc).</li>
              <li>✅ Leve toda a documentação ao balcão do Juizado Especial Cível (JEC) da sua cidade.</li>
            </ul>
            <button type="button" id="restart-quiz-btn" class="btn btn-primary">Começar Novamente</button>
          </div>

          <form id="petition-form" novalidate>
            <div class="progress-container">
              <div class="progress-bar-track"><div class="progress-bar-fill"></div></div>
              <p class="progress-text">Pergunta 1 de N</p>
            </div>

            <!-- Passos fixos + dinâmicos (seu conteúdo original mantido) -->
            <!-- ====== INÍCIO DOS STEPS ====== -->
            <div class="quiz-step" data-step-id="problem-type">
              <h3 class="quiz-question">Para começar, qual o seu problema com a concessionária de energia?</h3>
              <div class="form-group">
                <div class="options-grid">
                  <label><input type="radio" name="problem-type" value="corte_energia" required><span>Corte indevido de energia</span></label>
                  <label><input type="radio" name="problem-type" value="danos_eletricos" required><span>Oscilação/queda que danificou aparelhos</span></label>
                  <label><input type="radio" name="problem-type" value="toi" required><span>Multa / TOI indevido</span></label>
                  <label><input type="radio" name="problem-type" value="recusa_ligacao" required><span>Recusa na ligação de nova energia</span></label>
                  <label><input type="radio" name="problem-type" value="cobranca_indevida" required><span>Cobrança indevida na conta</span></label>
                  <label><input type="radio" name="problem-type" value="outro" required><span>Outro problema</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <div class="quiz-step" data-step-id="author-info">
              <h3 class="quiz-question">Ótimo. Agora, vamos aos seus dados. Qual é o seu nome completo?</h3>
              <div class="form-group">
                <input type="text" id="author-name" name="author-name" required placeholder="Digite seu nome completo">
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <div class="quiz-step" data-step-id="author-cpf">
              <h3 class="quiz-question">E o seu CPF?</h3>
              <div class="form-group">
                <input type="text" id="author-cpf" name="author-cpf" required placeholder="Digite seu CPF">
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <div class="quiz-step" data-step-id="author-address">
              <h3 class="quiz-question">Qual seu endereço completo?</h3>
              <div class="form-group">
                <input type="text" id="author-address" name="author-address" required placeholder="Rua, número, bairro, cidade e estado">
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <div class="quiz-step" data-step-id="author-contact">
              <h3 class="quiz-question">Para finalizar seus dados, qual seu e-mail e telefone?</h3>
              <div class="form-group">
                <input type="email" id="author-email" name="author-email" required placeholder="seuemail@exemplo.com">
                <div class="error-message">Campo obrigatório.</div>
              </div>
              <div class="form-group">
                <input type="tel" id="author-phone" name="author-phone" required placeholder="(XX) XXXXX-XXXX">
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <div class="quiz-step" data-step-id="company-info">
              <h3 class="quiz-question">Contra qual concessionária de energia é o processo?</h3>
              <div class="form-group">
                <input type="text" id="company-name" name="company-name" required placeholder="Ex: Enel, Neoenergia, Coelba, etc.">
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <!-- CORTE -->
            <div class="quiz-step" data-step-id="corte-data">
              <h3 class="quiz-question">Em que data a sua energia foi cortada?</h3>
              <div class="form-group">
                <input type="date" id="corte-data-input" name="corte-data" required>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="corte-aviso">
              <h3 class="quiz-question">A empresa avisou com antecedência que iria cortar?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="corte-aviso" value="sim" required><span>Sim</span></label>
                  <label><input type="radio" name="corte-aviso" value="nao" required><span>Não</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="corte-divida">
              <h3 class="quiz-question">Você tinha alguma conta em atraso no dia do corte?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="corte-divida" value="nao" required><span>Não, todas as contas estavam pagas</span></label>
                  <label><input type="radio" name="corte-divida" value="sim_indevida" required><span>Sim, mas a cobrança era indevida</span></label>
                  <label><input type="radio" name="corte-divida" value="discordo" required><span>Não concordo com a dívida que eles alegam</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="corte-religacao">
              <h3 class="quiz-question">Quando a energia foi religada (se já foi)?</h3>
              <div class="form-group">
                <input type="date" id="corte-religacao-data" name="corte-religacao-data">
                <p style="text-align:center; margin-top:1rem;">Se ainda não foi religada, pode deixar em branco.</p>
              </div>
            </div>
            <div class="quiz-step" data-step-id="corte-prejuizo-pergunta">
              <h3 class="quiz-question">Você teve algum prejuízo com alimentos estragados, medicamentos, perda de trabalho, etc?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="corte-prejuizo-pergunta" value="sim" required><span>Sim</span></label>
                  <label><input type="radio" name="corte-prejuizo-pergunta" value="nao" required><span>Não</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="corte-prejuizo-detalhes">
              <h3 class="quiz-question">Pode nos contar quais foram os prejuízos e o valor estimado?</h3>
              <div class="form-group">
                <textarea name="corte-prejuizo-detalhes" placeholder="Ex: Perdi R$200,00 em carnes e laticínios na geladeira."></textarea>
              </div>
            </div>

            <!-- OSCILAÇÃO -->
            <div class="quiz-step" data-step-id="oscilacao-data">
              <h3 class="quiz-question">Qual foi o dia da oscilação ou queda de energia que causou os danos?</h3>
              <div class="form-group">
                <input type="date" id="oscilacao-data-input" name="oscilacao-data" required>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="oscilacao-equipamentos">
              <h3 class="quiz-question">Quais equipamentos foram danificados?</h3>
              <div class="form-group">
                <textarea name="oscilacao-equipamentos" required placeholder="Liste os equipamentos com marca, modelo e valor aproximado."></textarea>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="oscilacao-comunicacao">
              <h3 class="quiz-question">Você comunicou o problema à empresa?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="oscilacao-comunicacao" value="sim" required><span>Sim, e anotei o protocolo</span></label>
                  <label><input type="radio" name="oscilacao-comunicacao" value="nao" required><span>Não</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="oscilacao-protocolo">
              <h3 class="quiz-question">Qual o número do protocolo e a data?</h3>
              <div class="form-group">
                <input type="text" name="oscilacao-protocolo" placeholder="Número do protocolo de atendimento">
              </div>
            </div>

            <!-- TOI -->
            <div class="quiz-step" data-step-id="toi-numero">
              <h3 class="quiz-question">Qual é o número do TOI (Termo de Ocorrência e Inspeção), se você tiver?</h3>
              <div class="form-group">
                <input type="text" id="toi-numero-input" name="toi-numero" placeholder="Pode deixar em branco se não tiver">
              </div>
            </div>
            <div class="quiz-step" data-step-id="toi-data">
              <h3 class="quiz-question">Qual foi a data da vistoria ou da emissão do TOI?</h3>
              <div class="form-group">
                <input type="date" id="toi-data-input" name="toi-data" required>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="toi-presente">
              <h3 class="quiz-question">Você estava presente no momento da vistoria?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="toi-presente" value="sim" required><span>Sim</span></label>
                  <label><input type="radio" name="toi-presente" value="nao" required><span>Não</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="toi-cobranca">
              <h3 class="quiz-question">Após o TOI, houve corte de energia, ameaça de corte ou cobrança da multa?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="toi-cobranca" value="sim" required><span>Sim</span></label>
                  <label><input type="radio" name="toi-cobranca" value="nao" required><span>Não</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <!-- RECUSA -->
            <div class="quiz-step" data-step-id="recusa-data-solicitacao">
              <h3 class="quiz-question">Em que data você fez a solicitação da nova ligação de energia?</h3>
              <div class="form-group">
                <input type="date" name="recusa-data-solicitacao" required>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="recusa-motivo">
              <h3 class="quiz-question">A empresa informou o motivo para recusar a ligação? Se sim, qual foi?</h3>
              <div class="form-group">
                <textarea name="recusa-motivo" placeholder="Descreva o motivo informado pela empresa, se houver."></textarea>
              </div>
            </div>
            <div class="quiz-step" data-step-id="recusa-protocolo">
              <h3 class="quiz-question">Você tem algum número de protocolo desse atendimento?</h3>
              <div class="form-group">
                <input type="text" name="recusa-protocolo" placeholder="Digite o protocolo, se tiver.">
              </div>
            </div>
            <div class="quiz-step" data-step-id="recusa-moradores">
              <h3 class="quiz-question">Há pessoas morando no imóvel que está sem energia?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="recusa-moradores" value="sim" required><span>Sim</span></label>
                  <label><input type="radio" name="recusa-moradores" value="nao" required><span>Não</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <!-- COBRANÇA -->
            <div class="quiz-step" data-step-id="cobranca-tipo">
              <h3 class="quiz-question">Qual tipo de cobrança indevida você recebeu?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="cobranca-tipo" value="conta_acima" required><span>Conta com valor muito acima do normal</span></label>
                  <label><input type="radio" name="cobranca-tipo" value="debito_inexistente" required><span>Débito que você não reconhece</span></label>
                  <label><input type="radio" name="cobranca-tipo" value="cobranca_repetida" required><span>Cobrança de uma conta que já foi paga</span></label>
                  <label><input type="radio" name="cobranca-tipo" value="tarifa_irregular" required><span>Inclusão de alguma tarifa ou serviço irregular</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="cobranca-reclamacao">
              <h3 class="quiz-question">Você chegou a reclamar com a empresa sobre essa cobrança?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="cobranca-reclamacao" value="sim" required><span>Sim</span></label>
                  <label><input type="radio" name="cobranca-reclamacao" value="nao" required><span>Não</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>
            <div class="quiz-step" data-step-id="cobranca-protocolos">
              <h3 class="quiz-question">Poderia informar os protocolos de reclamação?</h3>
              <div class="form-group">
                <textarea name="cobranca-protocolos" placeholder="Digite aqui os números de protocolo que você anotou."></textarea>
              </div>
            </div>
            <div class="quiz-step" data-step-id="cobranca-negativacao">
              <h3 class="quiz-question">Por causa dessa cobrança, seu nome foi negativado (SPC/Serasa)?</h3>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="cobranca-negativacao" value="sim" required><span>Sim</span></label>
                  <label><input type="radio" name="cobranca-negativacao" value="nao" required><span>Não</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <!-- EVIDÊNCIAS -->
            <div class="quiz-step" data-step-id="provas-gerais">
              <h3 class="quiz-question">Quais provas você tem para juntar ao processo?</h3>
              <p class="section-subtitle" style="margin-bottom:2rem; margin-top:-1.5rem;">Marque tudo o que você tiver. Quanto mais provas, melhor.</p>
              <div class="form-group">
                <div class="checkbox-options options-grid">
                  <label><input type="checkbox" name="provas" value="conta_energia"><span>Conta de energia</span></label>
                  <label><input type="checkbox" name="provas" value="protocolo"><span>Protocolo de atendimento</span></label>
                  <label><input type="checkbox" name="provas" value="fotos_videos"><span>Fotos / vídeos</span></label>
                  <label><input type="checkbox" name="provas" value="prints"><span>Prints do app/site</span></label>
                  <label><input type="checkbox" name="provas" value="orcamentos_notas"><span>Orçamentos / notas fiscais</span></label>
                  <label><input type="checkbox" name="provas" value="contrato"><span>Contrato / número da instalação</span></label>
                </div>
              </div>
            </div>

            <!-- VALORES -->
            <div class="quiz-step" data-step-id="valores-pedidos">
              <h3 class="quiz-question">Você quer pedir alguma indenização?</h3>
              <div class="form-group">
                <label for="material-value">Qual o valor total do seu prejuízo material (se houver)?</label>
                <input type="text" id="material-value" name="material-value" placeholder="R$ 0,00">
                <p style="font-size:.8rem; color:var(--neutral-medium); margin-top:4px;">Soma de tudo que você gastou e pode comprovar.</p>
              </div>
              <div class="form-group">
                <label>Você quer pedir indenização por danos morais?</label>
                <p style="font-size:.8rem; color:var(--neutral-medium); margin-bottom:8px;">Pelo constrangimento, tempo perdido e sofrimento.</p>
                <div class="radio-options">
                  <label><input type="radio" name="dano-moral-pergunta" value="sim" required><span>Sim</span></label>
                  <label><input type="radio" name="dano-moral-pergunta" value="nao" required><span>Não</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
              <div class="form-group" id="dano-moral-valor-group" style="display:none;">
                <label for="moral-value">Qual valor você sugere para os danos morais? (opcional)</label>
                <input type="text" id="moral-value" name="moral-value" placeholder="R$ 0,00">
              </div>
            </div>

            <!-- FINAIS -->
            <div class="quiz-step" data-step-id="info-finais">
              <h3 class="quiz-question">Estamos quase no fim! Em qual cidade e estado você vai entrar com a ação?</h3>
              <div class="form-group">
                <input type="text" id="cidade-estado" name="cidade-estado" required placeholder="Ex: São Paulo, SP">
                <div class="error-message">Campo obrigatório.</div>
              </div>
              <h3 class="quiz-question" style="font-size:1.5rem; margin-top:2rem;">Deseja pedir uma decisão urgente (liminar)?</h3>
              <p class="section-subtitle" style="margin-bottom:2rem; margin-top:-1.5rem;">Ex: religação imediata da energia, suspensão da cobrança do TOI, etc.</p>
              <div class="form-group">
                <div class="radio-options">
                  <label><input type="radio" name="urgency-request" value="sim" required><span>Sim, preciso de uma decisão rápida</span></label>
                  <label><input type="radio" name="urgency-request" value="nao" required><span>Não, posso aguardar</span></label>
                </div>
                <div class="error-message">Campo obrigatório.</div>
              </div>
            </div>

            <div class="quiz-navigation">
              <button type="button" id="prevBtn" class="btn btn-secondary">Anterior</button>
              <button type="button" id="nextBtn" class="btn btn-primary">Próximo</button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section id="faq">
      <div class="container">
        <h2 class="section-title">Perguntas Frequentes</h2>
        <p class="section-subtitle">Tire suas dúvidas sobre o nosso serviço e o Juizado Especial Cível.</p>
        <div class="faq-container">
          <div class="faq-item">
            <div class="faq-question">
              <span>O serviço substitui um advogado?</span><span class="faq-toggle">+</span>
            </div>
            <div class="faq-answer">
              <p>Não. Nossa ferramenta é educativa e gera uma proposta de petição inicial com base nos seus dados. Ela não oferece consultoria jurídica nem representa você. Para causas acima de 20 salários mínimos, a presença de um advogado é obrigatória por lei.</p>
            </div>
          </div>
          <div class="faq-item">
            <div class="faq-question">
              <span>Preciso pagar para usar?</span><span class="faq-toggle">+</span>
            </div>
            <div class="faq-answer">
              <p>A geração da petição através do nosso modelo básico é gratuita. Nosso objetivo é democratizar o acesso à justiça para causas mais simples.</p>
            </div>
          </div>
          <div class="faq-item">
            <div class="faq-question">
              <span>O que é o Juizado Especial Cível (JEC)?</span><span class="faq-toggle">+</span>
            </div>
            <div class="faq-answer">
              <p>Também conhecido como "juizado de pequenas causas", é uma parte da justiça criada para resolver de forma mais rápida, simples e sem custos, causas de menor complexidade e valor, como as de direito do consumidor.</p>
            </div>
          </div>
          <div class="faq-item">
            <div class="faq-question">
              <span>Qual o limite de valor da causa no JEC?</span><span class="faq-toggle">+</span>
            </div>
            <div class="faq-answer">
              <p>O limite é de 40 salários mínimos. Contudo, para ingressar sem advogado, o limite é de 20 salários mínimos. Nossa ferramenta foca em casos dentro deste limite.</p>
            </div>
          </div>
          <div class="faq-item">
            <div class="faq-question">
              <span>Como calculo o valor da causa?</span><span class="faq-toggle">+</span>
            </div>
            <div class="faq-answer">
              <p>O valor da causa é a soma de todos os seus pedidos. Some os valores dos danos materiais com uma estimativa razoável para os danos morais.</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container footer-content">
      <a href="#" class="logo">Sua<span>Petição</span></a>
      <ul class="footer-links">
        <li><a href="#">Termos de Uso</a></li>
        <li><a href="#">Política de Privacidade</a></li>
        <li><a href="#">Contato</a></li>
      </ul>
      <p>&copy; 2024 SuaPetição. Todos os direitos reservados. Este site não presta assessoria jurídica.</p>
    </div>
  </footer>

  <script>
    // URL do seu backend (Render)
    const API_URL = "https://backend-peticoes.onrender.com/api/generate-petition";

    // Bloqueio explícito se abrir como arquivo local (file://)
    if (location.protocol === "file:") {
      alert("Você abriu o arquivo diretamente (file://). Para funcionar, abra por http://localhost ou hospede o arquivo.\n\nSugestão rápida:\n1) No PowerShell, vá até a pasta do index.html\n2) Rode:  npx http-server -p 3000\n3) Acesse: http://localhost:3000");
    }

    document.addEventListener('DOMContentLoaded', function () {
      // "Acorda" a API (Render free pode hibernar)
      fetch(API_URL, { method: 'OPTIONS', mode: 'cors' }).catch(() => {});

      // UI header
      const header = document.getElementById('main-header');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 50) header.classList.add('scrolled'); else header.classList.remove('scrolled');
      });

      // Menu mobile
      const hamburger = document.querySelector('.hamburger');
      const navMenu = document.querySelector('.nav-menu');
      hamburger.addEventListener('click', () => { hamburger.classList.toggle('active'); navMenu.classList.toggle('active'); });
      document.querySelectorAll('a[href^="#"]').forEach(a => {
        a.addEventListener('click', e => {
          e.preventDefault();
          const id = a.getAttribute('href').substring(1);
          const el = document.getElementById(id);
          if (el) el.scrollIntoView({ behavior:'smooth' });
          if (navMenu.classList.contains('active')) { hamburger.classList.remove('active'); navMenu.classList.remove('active'); }
        });
      });

      // FAQ
      document.querySelectorAll('.faq-item').forEach(item => {
        item.querySelector('.faq-question').addEventListener('click', () => {
          item.classList.toggle('active');
          const ans = item.querySelector('.faq-answer');
          ans.style.maxHeight = item.classList.contains('active') ? ans.scrollHeight + "px" : null;
        });
      });

      // ----- QUIZ -----
      const form = document.getElementById('petition-form');
      const resultScreen = document.getElementById('result-screen');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const progressBarFill = document.querySelector('.progress-bar-fill');
      const progressText = document.querySelector('.progress-text');
      const allSteps = Array.from(document.querySelectorAll('.quiz-step'));

      const stepBlocks = {
        corte_energia: ['corte-data','corte-aviso','corte-divida','corte-religacao','corte-prejuizo-pergunta'],
        danos_eletricos: ['oscilacao-data','oscilacao-equipamentos','oscilacao-comunicacao'],
        toi: ['toi-numero','toi-data','toi-presente','toi-cobranca'],
        recusa_ligacao: ['recusa-data-solicitacao','recusa-motivo','recusa-protocolo','recusa-moradores'],
        cobranca_indevida: ['cobranca-tipo','cobranca-reclamacao','cobranca-negativacao'],
        outro: []
      };

      let quizFlow = [];
      let currentStepIndex = 0;

      function startQuiz() {
        quizFlow = ['problem-type','author-info','author-cpf','author-address','author-contact','company-info','provas-gerais','valores-pedidos','info-finais'];
        currentStepIndex = 0;
        showStep(currentStepIndex);
      }

      function showStep(i) {
        allSteps.forEach(s => s.classList.remove('active'));
        const id = quizFlow[i];
        const step = allSteps.find(s => s.dataset.stepId === id);
        if (step) {
          step.classList.add('active');
          const first = step.querySelector('input, select, textarea');
          if (first) first.focus();
        }
        updateProgress();
        updateNav();
      }

      function updateProgress() {
        const pct = Math.max(0, (currentStepIndex) / (quizFlow.length - 1)) * 100;
        progressBarFill.style.width = `${pct}%`;
        progressText.textContent = `Pergunta ${currentStepIndex + 1} de ${quizFlow.length}`;
      }

      function updateNav() {
        prevBtn.style.visibility = currentStepIndex === 0 ? 'hidden' : 'visible';
        nextBtn.textContent = currentStepIndex === quizFlow.length - 1 ? 'Gerar Petição' : 'Próximo';
      }

      function navigate(dir) {
        if (dir === 1) {
          if (!validateCurrentStep()) return;
          updateQuizFlow();
          if (currentStepIndex === quizFlow.length - 1) submitForm();
          else { currentStepIndex++; showStep(currentStepIndex); }
        } else {
          if (currentStepIndex > 0) { currentStepIndex--; showStep(currentStepIndex); }
        }
      }

      function validateCurrentStep() {
        let ok = true;
        const id = quizFlow[currentStepIndex];
        const step = allSteps.find(s => s.dataset.stepId === id);
        step.querySelectorAll('[required]').forEach(input => {
          const group = input.closest('.form-group');
          let valid = true;
          if (input.type === 'radio' || input.type === 'checkbox') {
            const checked = step.querySelector(`input[name="${input.name}"]:checked`);
            if (!checked) valid = false;
          } else if (!input.value.trim()) valid = false;
          if (!valid) { ok = false; if (group) group.classList.add('invalid'); }
          else if (group) group.classList.remove('invalid');
        });
        return ok;
      }

      function updateQuizFlow() {
        const data = Object.fromEntries(new FormData(form).entries());
        const allDyn = Object.values(stepBlocks).flat();
        quizFlow = quizFlow.filter(s => !allDyn.includes(s));
        const type = data['problem-type'];
        if (type && stepBlocks[type]) {
          const idx = quizFlow.indexOf('company-info');
          if (idx > -1) quizFlow.splice(idx + 1, 0, ...stepBlocks[type]);
        }
        const cond = {
          'corte-prejuizo-detalhes': data['corte-prejuizo-pergunta'] === 'sim' ? 'corte-prejuizo-pergunta' : null,
          'oscilacao-protocolo': data['oscilacao-comunicacao'] === 'sim' ? 'oscilacao-comunicacao' : null,
          'cobranca-protocolos': data['cobranca-reclamacao'] === 'sim' ? 'cobranca-reclamacao' : null,
        };
        quizFlow = quizFlow.filter(s => !Object.keys(cond).includes(s));
        for (const [s, t] of Object.entries(cond)) {
          if (t) {
            const idx = quizFlow.indexOf(t);
            if (idx > -1) quizFlow.splice(idx + 1, 0, s);
          }
        }
      }

      async function submitForm() {
        nextBtn.textContent = 'Gerando...';
        nextBtn.disabled = true;

        const fd = new FormData(form);
        const data = {};
        fd.forEach((v, k) => {
          if (data[k]) {
            if (!Array.isArray(data[k])) data[k] = [data[k]];
            data[k].push(v);
          } else data[k] = v;
        });

        try {
          const controller = new AbortController();
          const to = setTimeout(() => controller.abort(), 60000); // 60s timeout

          const resp = await fetch(API_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
            mode: 'cors',
            signal: controller.signal
          });
          clearTimeout(to);

          if (!resp.ok) {
            const err = await resp.json().catch(() => ({}));
            throw new Error(err.error || `Erro no servidor (${resp.status})`);
          }

          const result = await resp.json();
          const petitionText = result.text || 'A IA não retornou texto. Tente novamente.';

          const { jsPDF } = window.jspdf;
          const doc = new jsPDF({ orientation:'p', unit:'mm', format:'a4' });
          const margin = 20;
          const maxW = doc.internal.pageSize.width - margin * 2;
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(12);

          const lines = doc.splitTextToSize(petitionText, maxW);
          let y = margin;
          for (const line of lines) {
            if (y > doc.internal.pageSize.height - margin) { doc.addPage(); y = margin; }
            doc.text(line, margin, y);
            y += 7;
          }
          doc.save('peticao.pdf');

          setTimeout(() => {
            form.style.display = 'none';
            resultScreen.style.display = 'block';
          }, 300);

        } catch (e) {
          console.error(e);
          let msg = e.name === 'AbortError'
            ? 'Tempo excedido ao conectar no servidor.'
            : e.message || 'Falha desconhecida.';
          alert('Ocorreu um erro ao gerar a petição: ' + msg);
        } finally {
          nextBtn.textContent = 'Gerar Petição';
          nextBtn.disabled = false;
        }
      }

      // feedback imediato de validação
      form.querySelectorAll('input, select, textarea').forEach(input => {
        const evt = (input.tagName === 'SELECT' || input.type === 'radio' || input.type === 'checkbox') ? 'change' : 'input';
        input.addEventListener(evt, e => e.target.closest('.form-group')?.classList.remove('invalid'));
      });

      // navegação
      nextBtn.addEventListener('click', () => navigate(1));
      prevBtn.addEventListener('click', () => navigate(-1));

      document.getElementById('restart-quiz-btn').addEventListener('click', () => {
        resultScreen.style.display = 'none';
        form.style.display = 'block';
        form.reset();
        startQuiz();
      });

      // mostrar campo de dano moral
      const danoMoralRadio = document.querySelectorAll('input[name="dano-moral-pergunta"]');
      const danoMoralValueGroup = document.getElementById('dano-moral-valor-group');
      danoMoralRadio.forEach(r => r.addEventListener('change', e => {
        danoMoralValueGroup.style.display = e.target.value === 'sim' ? 'block' : 'none';
      }));

      // máscara simples de moeda
      ['moral-value','material-value'].forEach(id => {
        const input = document.getElementById(id);
        if (!input) return;
        input.addEventListener('input', () => {
          let v = input.value.replace(/\D/g,'');
          if (!v) { input.value = ''; return; }
          v = (parseInt(v,10)/100).toLocaleString('pt-BR',{style:'currency', currency:'BRL'});
          input.value = v;
        });
      });

      // inicia
      startQuiz();
    });
  </script>
</body>
</html>
