<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuaPetição - Gerador de Petições com IA</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary-green-dark: #004d40;
            --primary-green-medium: #26a69a;
            --primary-green-light: #e0f2f1;
            --neutral-dark: #212121;
            --neutral-medium: #616161;
            --neutral-light: #f5f5f5;
            --background-color: #ffffff;
            --error-color: #d32f2f;
            --error-background: #ffebee;
        }
        *{margin:0;padding:0;box-sizing:border-box;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
        html{scroll-behavior:smooth}
        body{font-family:'Poppins',sans-serif;background-color:var(--background-color);color:var(--neutral-dark);font-size:16px;line-height:1.6}
        .container{max-width:1100px;margin:0 auto;padding:0 20px}
        header{background-color:var(--background-color);padding:1rem 0;border-bottom:1px solid #e0e0e0;position:fixed;top:0;left:0;width:100%;z-index:1000;transition:box-shadow .3s ease}
        header.scrolled{box-shadow:0 2px 10px rgba(0,0,0,.05)}
        .header-content{display:flex;justify-content:space-between;align-items:center}
        .logo{font-size:1.5rem;font-weight:700;color:var(--primary-green-dark);text-decoration:none}
        .logo span{color:var(--primary-green-medium)}
        nav ul{display:flex;align-items:center;list-style:none;gap:1.5rem}
        nav a:not(.btn){text-decoration:none;color:var(--neutral-medium);font-weight:500;position:relative;transition:color .3s ease;padding:.5rem 0}
        nav a:not(.btn):hover{color:var(--primary-green-dark)}
        nav a:not(.btn)::after{content:'';position:absolute;width:0;height:2px;bottom:0;left:0;background-color:var(--primary-green-medium);transition:width .3s ease}
        nav a:not(.btn):hover::after{width:100%}
        .hamburger{display:none;cursor:pointer;border:none;background:none}
        .hamburger .bar{display:block;width:25px;height:3px;margin:5px auto;background-color:var(--primary-green-dark);transition:all .3s ease-in-out}
        .btn{padding:.75rem 1.5rem;border-radius:50px;text-decoration:none;font-weight:600;transition:all .3s ease;display:inline-block;text-align:center;border:none;cursor:pointer}
        .btn-primary{background-color:var(--primary-green-medium);color:#fff;box-shadow:0 4px 15px rgba(0,121,107,.2)}
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,121,107,.3)}
        .btn-secondary{border:2px solid var(--primary-green-medium);color:var(--primary-green-medium);background-color:transparent}
        .btn-secondary:hover{background-color:var(--primary-green-medium);color:#fff}
        section{padding:6rem 0}
        .section-title{text-align:center;font-size:2.5rem;font-weight:700;color:var(--primary-green-dark);margin-bottom:1rem}
        .section-subtitle{text-align:center;font-size:1.1rem;color:var(--neutral-medium);max-width:600px;margin:0 auto 4rem}
        #hero{padding-top:10rem;min-height:100vh;display:flex;align-items:center}
        .hero-content{display:flex;align-items:center;justify-content:space-between;gap:4rem}
        .hero-text{max-width:50%}
        .hero-text h1{font-size:3rem;font-weight:700;line-height:1.2;color:var(--primary-green-dark);margin-bottom:1rem}
        .hero-text p{font-size:1.2rem;color:var(--neutral-medium);margin-bottom:2rem}
        .hero-image{max-width:45%}
        .hero-image img{width:100%;height:auto;border-radius:10px}
        #how-it-works{background-color:var(--neutral-light)}
        .steps-container{display:flex;justify-content:space-around;gap:2rem;margin-top:4rem}
        .step-card{background:#fff;padding:2.5rem 2rem;border-radius:10px;text-align:center;box-shadow:0 5px 25px rgba(0,0,0,.05);transition:transform .3s ease,box-shadow .3s ease;flex:1}
        .step-card:hover{transform:translateY(-10px);box-shadow:0 10px 30px rgba(0,0,0,.08)}
        .step-number{font-size:3rem;font-weight:700;color:var(--primary-green-light);background-color:var(--primary-green-medium);width:80px;height:80px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 1.5rem}
        .step-card h3{font-size:1.5rem;color:var(--primary-green-dark);margin-bottom:.5rem}
        .faq-item{border-bottom:1px solid #e0e0e0;padding:1.5rem 0}
        .faq-question{display:flex;justify-content:space-between;align-items:center;cursor:pointer;font-size:1.2rem;font-weight:600}
        .faq-question:hover{color:var(--primary-green-medium)}
        .faq-answer{max-height:0;overflow:hidden;transition:max-height .3s ease-out;color:var(--neutral-medium)}
        .faq-answer p{padding-top:1rem}
        .faq-item.active .faq-answer{padding-bottom:1rem}
        .faq-toggle{font-size:1.5rem;font-weight:700;transition:transform .3s ease}
        .faq-item.active .faq-toggle{transform:rotate(45deg)}
        #form-section{background-color:var(--neutral-light)}
        .form-container{background:#fff;padding:3rem;border-radius:10px;box-shadow:0 5px 25px rgba(0,0,0,.07);max-width:800px;margin:0 auto;overflow:hidden}
        .quiz-step{display:none;animation:fadeIn .5s ease-in-out}
        .quiz-step.active{display:block}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .quiz-question{font-size:1.75rem;font-weight:600;color:var(--primary-green-dark);margin-bottom:2rem;text-align:center}
        .form-group{display:flex;flex-direction:column;margin-bottom:1.5rem}
        .form-group label{font-weight:600;margin-bottom:.5rem;color:var(--primary-green-dark)}
        .form-group input,.form-group select,.form-group textarea{width:100%;padding:.8rem 1rem;border-radius:8px;border:1px solid #ccc;font-family:'Poppins',sans-serif;font-size:1rem;transition:border-color .3s,box-shadow .3s}
        .form-group input:focus,.form-group select:focus,.form-group textarea:focus{outline:none;border-color:var(--primary-green-medium);box-shadow:0 0 0 3px rgba(38,166,154,.2)}
        .form-group textarea{min-height:120px;resize:vertical}
        .options-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem;justify-content:center}
        .radio-options{display:flex;flex-direction:column;gap:1rem}
        .options-grid label,.radio-options label,.checkbox-options label{display:flex;align-items:center;gap:.75rem;cursor:pointer;font-weight:500;padding:.8rem 1.5rem;border:1px solid #ccc;border-radius:8px;transition:all .2s ease;text-align:left}
        .options-grid label:hover,.radio-options label:hover,.checkbox-options label:hover{background:var(--primary-green-light);border-color:var(--primary-green-medium)}
        .options-grid input[type=radio],.radio-options input[type=radio],.checkbox-options input[type=checkbox]{display:none}
        .options-grid input[type=radio]:checked~span,.radio-options input[type=radio]:checked~span,.checkbox-options input[type=checkbox]:checked~span{font-weight:600;color:var(--primary-green-dark)}
        .options-grid input[type=radio]:checked~span::before,.radio-options input[type=radio]:checked~span::before,.checkbox-options input[type=checkbox]:checked~span::before{content:'✔';margin-right:.5rem;color:var(--primary-green-medium)}
        .options-grid input[type=radio]:checked+label,.radio-options input[type=radio]:checked+label,.checkbox-options input[type=checkbox]:checked+label{border-color:var(--primary-green-medium);background:var(--primary-green-light)}
        .form-group.invalid input,.form-group.invalid select,.form-group.invalid textarea{border:1px solid var(--error-color);background:var(--error-background)}
        .form-group.invalid .options-grid,.form-group.invalid .radio-options,.form-group.invalid .checkbox-options{border:1px solid var(--error-color);background:var(--error-background);border-radius:8px;padding:1rem}
        .error-message{color:var(--error-color);font-size:.875rem;margin-top:.25rem;display:none}
        .form-group.invalid .error-message{display:block}
        .progress-container{margin-bottom:2rem;position:relative}
        .progress-bar-track{width:100%;height:10px;background:#e0e0e0;border-radius:5px;overflow:hidden}
        .progress-bar-fill{width:0%;height:100%;background:var(--primary-green-medium);border-radius:5px;transition:width .4s ease}
        .progress-text{text-align:center;margin-top:.5rem;color:var(--neutral-medium);font-weight:500}
        .quiz-navigation{display:flex;justify-content:space-between;margin-top:3rem}
        .quiz-navigation button{font-size:1rem}
        #result-screen{text-align:center}
        #result-screen h3{font-size:2rem;color:var(--primary-green-dark);margin-bottom:1rem}
        #result-screen p{font-size:1.1rem;color:var(--neutral-medium);margin-bottom:2rem}
        #result-screen ul{list-style:none;text-align:left;display:inline-block;margin-bottom:2.5rem}
        #result-screen ul li{font-size:1.1rem;margin-bottom:1rem}
        footer{background-color:var(--primary-green-dark);color:#fff;padding:3rem 0;text-align:center}
        .footer-content{display:flex;flex-direction:column;align-items:center;gap:1.5rem}
        .footer-links{list-style:none;display:flex;gap:1.5rem}
        .footer-links a{color:#fff;text-decoration:none;transition:color .3s ease}
        .footer-links a:hover{color:var(--primary-green-medium)}
        @media (max-width:992px){.hero-content{flex-direction:column;text-align:center}.hero-text,.hero-image{max-width:100%}.steps-container{flex-direction:column}}
        @media (max-width:768px){
            html{font-size:93.75%}
            nav ul{position:fixed;left:-100%;top:73px;flex-direction:column;background:#fff;width:100%;text-align:center;transition:.3s;gap:0;box-shadow:0 10px 10px rgba(0,0,0,.05)}
            nav ul.active{left:0}
            nav li{width:100%}
            nav a{padding:1.5rem 1rem;display:block;width:100%;border-bottom:1px solid #f0f0f0}
            .btn-nav{margin:1rem;display:block}
            nav a:not(.btn)::after{display:none}
            .hamburger{display:block}
            .hamburger.active .bar:nth-child(2){opacity:0}
            .hamburger.active .bar:nth-child(1){transform:translateY(8px) rotate(45deg)}
            .hamburger.active .bar:nth-child(3){transform:translateY(-8px) rotate(-45deg)}
            .form-container{padding:2rem}
        }
    </style>
</head>
<body>
    <header id="main-header">
        <div class="container header-content">
            <a href="#" class="logo">Sua<span>Petição</span></a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#how-it-works">Como funciona</a></li>
                    <li><a href="#faq">Perguntas frequentes</a></li>
                    <li><a href="#">Contato</a></li>
                    <li><a href="#">Meu perfil</a></li>
                    <li><a href="#form-section" class="btn btn-secondary btn-nav">Criar Petição</a></li>
                </ul>
            </nav>
            <button class="hamburger"><span class="bar"></span><span class="bar"></span><span class="bar"></span></button>
        </div>
    </header>

    <main>
        <!-- HERO -->
        <section id="hero">
            <div class="container hero-content">
                <div class="hero-text">
                    <h1>Gerador de Petições Iniciais com Inteligência Artificial</h1>
                    <p>Rápido, simples e pronto para protocolar no Juizado. Crie seu documento jurídico em minutos e defenda seus direitos com mais facilidade.</p>
                    <a href="#form-section" class="btn btn-primary">Criar Petição Agora</a>
                </div>
                <div class="hero-image">
                    <img src="https://images.unsplash.com/photo-1560520653-9e0e4c89eb18?q=80&w=1200&auto=format&fit=crop" alt="Pessoa assinando um documento legal">
                </div>
            </div>
        </section>

        <!-- COMO FUNCIONA -->
        <section id="how-it-works">
            <div class="container">
                <h2 class="section-title">Como Funciona?</h2>
                <p class="section-subtitle">Em três passos simples, sua petição estará pronta para ser protocolada.</p>
                <div class="steps-container">
                    <div class="step-card">
                        <div class="step-number">1</div>
                        <h3>Preencha o Formulário</h3>
                        <p>Informe os detalhes do seu caso de forma guiada e intuitiva. Nossa plataforma pergunta tudo o que é necessário.</p>
                    </div>
                    <div class="step-card">
                        <div class="step-number">2</div>
                        <h3>A IA Monta a Petição</h3>
                        <p>Nossa Inteligência Artificial analisa suas informações e redige uma petição inicial completa, em linguagem jurídica e formatada corretamente.</p>
                    </div>
                    <div class="step-card">
                        <div class="step-number">3</div>
                        <h3>Imprima e Protocole</h3>
                        <p>Você recebe o documento pronto para imprimir, assinar e levar ao Juizado Especial Cível da sua cidade, junto com seus documentos.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- FORM -->
        <section id="form-section">
            <div class="container">
                <h2 class="section-title">Crie Sua Petição</h2>
                <p class="section-subtitle">Responda algumas perguntas e nossa IA montará o documento para você.</p>
                <div class="form-container" id="quiz-wrapper">
                    <div id="result-screen" style="display:none;">
                        <h3>Petição Gerada com Sucesso!</h3>
                        <p>Seu documento foi baixado. Siga os próximos passos para protocolar sua ação:</p>
                        <ul>
                            <li>✅ Abra o arquivo 'peticao.pdf' que foi salvo no seu computador.</li>
                            <li>✅ Imprima 3 vias do documento.</li>
                            <li>✅ Junte cópias dos seus documentos pessoais (RG, CPF, Comprovante de Residência).</li>
                            <li>✅ Anexe todas as provas que você mencionou (notas fiscais, protocolos, prints, etc).</li>
                            <li>✅ Leve toda a documentação ao balcão do Juizado Especial Cível (JEC) da sua cidade.</li>
                        </ul>
                        <button type="button" id="restart-quiz-btn" class="btn btn-primary">Começar Novamente</button>
                    </div>

                    <form id="petition-form" novalidate>
                        <div class="progress-container">
                            <div class="progress-bar-track"><div class="progress-bar-fill"></div></div>
                            <p class="progress-text">Pergunta 1 de N</p>
                        </div>

                        <!-- passos fixos/dinâmicos (iguais ao seu arquivo) -->
                        <!-- ... (mantive todos os passos que você já tinha) ... -->
                        <!-- Para encurtar, deixei os steps exatamente como no seu envio -->
                        <!-- INÍCIO DOS STEPS -->
                        <!-- == cole aqui todo o bloco de steps exatamente como no seu arquivo anterior == -->
                        <!-- Mantive 100% igual ao que você enviou, sem alterações de conteúdo dos steps -->
                        <!-- FIM DOS STEPS -->

                        <!-- (Para manter a resposta concisa, omiti os steps no meio; use exatamente os que você me enviou) -->
                    </form>
                </div>
            </div>
        </section>

        <!-- FAQ -->
        <section id="faq">
            <div class="container">
                <h2 class="section-title">Perguntas Frequentes</h2>
                <p class="section-subtitle">Tire suas dúvidas sobre o nosso serviço e o Juizado Especial Cível.</p>
                <div class="faq-container">
                    <!-- itens FAQ (sem alterações) -->
                    <!-- ... -->
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container footer-content">
            <a href="#" class="logo">Sua<span>Petição</span></a>
            <ul class="footer-links">
                <li><a href="#">Termos de Uso</a></li>
                <li><a href="#">Política de Privacidade</a></li>
                <li><a href="#">Contato</a></li>
            </ul>
            <p>&copy; 2024 SuaPetição. Todos os direitos reservados. Este site não presta assessoria jurídica.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // ✅ URL do seu backend no Render
            const API_URL = "https://backend-peticoes.onrender.com/api/generate-petition";

            // Acorda o backend (facilita a 1ª chamada no Render free)
            fetch(API_URL.replace('/api/generate-petition', '/'), { method: 'GET' }).catch(() => {});

            // Header scroll
            const header = document.getElementById('main-header');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) header.classList.add('scrolled'); else header.classList.remove('scrolled');
            });

            // Menu mobile
            const hamburger = document.querySelector('.hamburger');
            const navMenu = document.querySelector('.nav-menu');
            hamburger.addEventListener('click', () => { hamburger.classList.toggle('active'); navMenu.classList.toggle('active'); });
            document.querySelectorAll('a[href^="#"]').forEach(a => {
                a.addEventListener('click', e => {
                    e.preventDefault();
                    const id = a.getAttribute('href').substring(1);
                    const el = document.getElementById(id);
                    if (el) el.scrollIntoView({ behavior: 'smooth' });
                    if (navMenu.classList.contains('active')) { hamburger.classList.remove('active'); navMenu.classList.remove('active'); }
                });
            });

            // FAQ
            document.querySelectorAll('.faq-item').forEach(item => {
                item.querySelector('.faq-question').addEventListener('click', () => {
                    item.classList.toggle('active');
                    const ans = item.querySelector('.faq-answer');
                    ans.style.maxHeight = item.classList.contains('active') ? ans.scrollHeight + "px" : null;
                });
            });

            // ----- QUIZ -----
            const form = document.getElementById('petition-form');
            const resultScreen = document.getElementById('result-screen');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const progressBarFill = document.querySelector('.progress-bar-fill');
            const progressText = document.querySelector('.progress-text');
            const allSteps = Array.from(document.querySelectorAll('.quiz-step'));

            const stepBlocks = {
                corte_energia: ['corte-data','corte-aviso','corte-divida','corte-religacao','corte-prejuizo-pergunta'],
                danos_eletricos: ['oscilacao-data','oscilacao-equipamentos','oscilacao-comunicacao'],
                toi: ['toi-numero','toi-data','toi-presente','toi-cobranca'],
                recusa_ligacao: ['recusa-data-solicitacao','recusa-motivo','recusa-protocolo','recusa-moradores'],
                cobranca_indevida: ['cobranca-tipo','cobranca-reclamacao','cobranca-negativacao'],
                outro: []
            };

            let quizFlow = [];
            let currentStepIndex = 0;

            function startQuiz() {
                quizFlow = ['problem-type','author-info','author-cpf','author-address','author-contact','company-info','provas-gerais','valores-pedidos','info-finais'];
                currentStepIndex = 0;
                showStep(currentStepIndex);
            }

            function showStep(i) {
                allSteps.forEach(s => s.classList.remove('active'));
                const id = quizFlow[i];
                const step = allSteps.find(s => s.dataset.stepId === id);
                if (step) {
                    step.classList.add('active');
                    const first = step.querySelector('input, select, textarea');
                    if (first) first.focus();
                }
                updateProgress(); updateNav();
            }

            function updateProgress() {
                const pct = Math.max(0, (currentStepIndex) / (quizFlow.length - 1)) * 100;
                progressBarFill.style.width = `${pct}%`;
                progressText.textContent = `Pergunta ${currentStepIndex + 1} de ${quizFlow.length}`;
            }

            function updateNav() {
                prevBtn.style.visibility = currentStepIndex === 0 ? 'hidden' : 'visible';
                nextBtn.textContent = currentStepIndex === quizFlow.length - 1 ? 'Gerar Petição' : 'Próximo';
            }

            function navigate(dir) {
                if (dir === 1) {
                    if (!validateCurrentStep()) return;
                    updateQuizFlow();
                    if (currentStepIndex === quizFlow.length - 1) submitForm();
                    else { currentStepIndex++; showStep(currentStepIndex); }
                } else {
                    if (currentStepIndex > 0) { currentStepIndex--; showStep(currentStepIndex); }
                }
            }

            function validateCurrentStep() {
                let ok = true;
                const id = quizFlow[currentStepIndex];
                const step = allSteps.find(s => s.dataset.stepId === id);
                step.querySelectorAll('[required]').forEach(input => {
                    const group = input.closest('.form-group');
                    let valid = true;
                    if (input.type === 'radio' || input.type === 'checkbox') {
                        const checked = step.querySelector(`input[name="${input.name}"]:checked`);
                        if (!checked) valid = false;
                    } else if (!input.value.trim()) valid = false;
                    if (!valid) { ok = false; if (group) group.classList.add('invalid'); }
                    else if (group) group.classList.remove('invalid');
                });
                return ok;
            }

            function updateQuizFlow() {
                const data = Object.fromEntries(new FormData(form).entries());
                const allDyn = Object.values(stepBlocks).flat();
                quizFlow = quizFlow.filter(s => !allDyn.includes(s));
                const type = data['problem-type'];
                if (type && stepBlocks[type]) {
                    const idx = quizFlow.indexOf('company-info');
                    if (idx > -1) quizFlow.splice(idx + 1, 0, ...stepBlocks[type]);
                }
                const cond = {
                    'corte-prejuizo-detalhes': data['corte-prejuizo-pergunta'] === 'sim' ? 'corte-prejuizo-pergunta' : null,
                    'oscilacao-protocolo': data['oscilacao-comunicacao'] === 'sim' ? 'oscilacao-comunicacao' : null,
                    'cobranca-protocolos': data['cobranca-reclamacao'] === 'sim' ? 'cobranca-reclamacao' : null,
                };
                quizFlow = quizFlow.filter(s => !Object.keys(cond).includes(s));
                for (const [s, t] of Object.entries(cond)) {
                    if (t) {
                        const idx = quizFlow.indexOf(t);
                        if (idx > -1) quizFlow.splice(idx + 1, 0, s);
                    }
                }
            }

            async function submitForm() {
                nextBtn.textContent = 'Gerando...';
                nextBtn.disabled = true;

                const fd = new FormData(form);
                const data = {};
                fd.forEach((v, k) => {
                    if (data[k]) { if (!Array.isArray(data[k])) data[k] = [data[k]]; data[k].push(v); }
                    else data[k] = v;
                });

                try {
                    const resp = await fetch(API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data),
                        mode: 'cors'
                    });

                    if (!resp.ok) {
                        const err = await resp.json().catch(() => ({}));
                        throw new Error(err.error || `Erro no servidor (${resp.status})`);
                    }

                    const result = await resp.json();
                    const petitionText = result.text || 'A IA não retornou texto. Tente novamente.';

                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF({ orientation:'p', unit:'mm', format:'a4' });
                    const margin = 20;
                    const maxW = doc.internal.pageSize.width - margin * 2;
                    doc.setFont('helvetica','normal'); doc.setFontSize(12);

                    const lines = doc.splitTextToSize(petitionText, maxW);
                    let y = margin;
                    for (const line of lines) {
                        if (y > doc.internal.pageSize.height - margin) { doc.addPage(); y = margin; }
                        doc.text(line, margin, y); y += 7;
                    }
                    doc.save('peticao.pdf');

                    setTimeout(() => { form.style.display='none'; resultScreen.style.display='block'; }, 300);

                } catch (e) {
                    console.error(e);
                    alert('Ocorreu um erro ao gerar a petição: ' + (e.message || 'Falha desconhecida.'));
                } finally {
                    nextBtn.textContent = 'Gerar Petição';
                    nextBtn.disabled = false;
                }
            }

            // feedback/validação
            form.querySelectorAll('input, select, textarea').forEach(input => {
                const evt = (input.tagName === 'SELECT' || input.type === 'radio' || input.type === 'checkbox') ? 'change' : 'input';
                input.addEventListener(evt, e => e.target.closest('.form-group')?.classList.remove('invalid'));
            });

            nextBtn.addEventListener('click', () => navigate(1));
            prevBtn.addEventListener('click', () => navigate(-1));

            document.getElementById('restart-quiz-btn').addEventListener('click', () => {
                resultScreen.style.display='none'; form.style.display='block'; form.reset(); startQuiz();
            });

            const danoMoralRadio = document.querySelectorAll('input[name="dano-moral-pergunta"]');
            const danoMoralValueGroup = document.getElementById('dano-moral-valor-group');
            danoMoralRadio.forEach(r => r.addEventListener('change', e => {
                danoMoralValueGroup.style.display = e.target.value === 'sim' ? 'block' : 'none';
            }));

            ['moral-value','material-value'].forEach(id => {
                const input = document.getElementById(id);
                if (!input) return;
                input.addEventListener('input', () => {
                    let v = input.value.replace(/\D/g,'');
                    if (!v) { input.value=''; return; }
                    v = (parseInt(v,10)/100).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
                    input.value = v;
                });
            });

            startQuiz();
        });
    </script>
</body>
</html>
